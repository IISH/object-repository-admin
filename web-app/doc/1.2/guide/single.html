<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Object-repository 1.2</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#architecture"><strong>2</strong><span>Architecture</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#stagingarea"><strong>3</strong><span>Staging area</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#readonlyftp"><strong>4</strong><span>Download files using ftp</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#instruction"><strong>5</strong><span>Prepare the ingest</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#pid"><strong>6</strong><span>PIDs and the repository's resolve urls</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#compound"><strong>7</strong><span>Compound objects</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#administration"><strong>8</strong><span>Administration interface</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                
            </div>
            <p>object-repository-admin</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>Object-repository - Reference Documentation</h1>
                            <p><strong>Authors:</strong> Lucien van Wouw</p>
                            <p><strong>Version:</strong> 1.2</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#changes"><strong>1.1</strong><span>Change Log</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#milestones"><strong>1.2</strong><span>Milestones</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#roadmap"><strong>1.3</strong><span>Roadmap</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#architecture"><strong>2</strong><span>Architecture</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#architectureWorkflowService"><strong>2.1</strong><span>Workflow services</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#architectureWorkflowServiceInitiate"><strong>2.1.1</strong><span>Initiate</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#architectureWorkflowServiceActive"><strong>2.1.2</strong><span>Active</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#architectureWorkflowServiceRetire"><strong>2.1.3</strong><span>End</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#architectureMessageQueue"><strong>2.2</strong><span>Message queue producer</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#architectureMessageQueueInstruction"><strong>2.2.1</strong><span>Processing instruction consumer</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#architectureMessageQueueIngest"><strong>2.2.2</strong><span>Ingest consumer</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#architectureMessageQueueDerivative"><strong>2.2.3</strong><span>Derivative consumer</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#architectureMessageQueuePidWebservice"><strong>2.2.4</strong><span>PID consumer</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#stagingarea"><strong>3</strong><span>Staging area</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#ftp"><strong>3.1</strong><span>FTP</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#datasets"><strong>3.2</strong><span>Datasets</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#customderivatives"><strong>3.3</strong><span>Your own derivatives</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#readonlyftp"><strong>4</strong><span>Download files using ftp</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#instruction"><strong>5</strong><span>Prepare the ingest</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#settings"><strong>5.1</strong><span>Instruction settings</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#xmlinstruction"><strong>5.2</strong><span>The XML instruction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#running"><strong>5.3</strong><span>Starting\run an instruction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#pid"><strong>6</strong><span>PIDs and the repository's resolve urls</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#resolveurls"><strong>6.1</strong><span>Resolve URLs</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#pids"><strong>6.2</strong><span>PIDs created via the PID webservice</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#compound"><strong>7</strong><span>Compound objects</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#objid"><strong>7.1</strong><span>Object identifiers and file order</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#mets"><strong>7.2</strong><span>Mets</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#pdf"><strong>7.3</strong><span>Pdf</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#administration"><strong>8</strong><span>Administration interface</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#user"><strong>8.1</strong><span>Ftp accounts</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#profile"><strong>8.2</strong><span>Profile</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#policy"><strong>8.3</strong><span>Access policies</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#instructions"><strong>8.4</strong><span>Managing and monitoring instructions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#orfiles"><strong>8.5</strong><span>Stored files</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="introduction">1 Introduction</h1>
The object repository is part of a service oriented framework. That is, the latter offers a collection of services:
<ul class="star">
<li>ftp upload of files to a staging area (temporary storage)</li>
<li>ingesting those files into persistent storage</li>
<li>image, audio and video derivative generation</li>
<li>accepts custom made derivatives of any content type</li>
<li>persistent identifier creation by calling a PID webservice (binding file and compound object locations and their handles via a [PID webservice|]https://pid.socialhistoryservices.org/.)</li>
<li>dissemination of the resources via HTTP and FTP</li>
<li>exports compound objects by via METS and PDF</li>
<li>an administration interface plus account system to manage the above services and access policies</li>
</ul><p class="paragraph"/>


<h2 id="changes">1.1 Change Log</h2>
<h3>Current release - version 1.2</h3>
<ul class="star">
<li>the structure of compound objects can be expressed in the processing instruction: file order and a group identifier</li>
<li>based on this structure; it is possible to export METS and PDF files on the fly via dissemination</li>
<li>a PID can be set for the group identifier</li>
<li>instructions can be recreated after an ingest</li>
<li>pid lookup is possible at the "stored objects" panel</li>
<li>read only FTP access to the master and derivatives for administrative accounts</li>
</ul><p class="paragraph"/>Deprecated: CPADMIN accounts can no longer be set via the administration interface. Contact the administrator of to
distribute such privileged accounts.<p class="paragraph"/><h3>Version 1.1</h3>
<ul class="star">
<li>Derivative production of audio&#118;ideo</li>
<li>Custom policies can change the default 'closed' access for masters to open and restricted</li>
<li>Deletion of masters and derivatives are removable via an instruction</li>
<li>Content and usage statistics are available on the main dashboard</li>
</ul><p class="paragraph"/><h3>Version 1.0.1</h3>
The administration interface has links in the footer to:
<ul class="star">
<li>Build info showing the most recent changes</li>
<li>For reporting bugs and feature request please visit <a href="../ref/Httpsjirasocialhistoryservicesorgbrowse OR/Jira.html" class="https://jira.socialhistoryservices.org/browse/OR">Jira</a></li>
</ul><p class="paragraph"/><h3>Version 1.0</h3>
First release



<h2 id="milestones">1.2 Milestones</h2>
<h3>Detailed milestones (until June 2013)</h3><p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">date</strong></th><th><strong class="bold">milestone</strong></th><th><strong class="bold">status</strong></th></tr><tr class="table-odd"><td>June 2012</td><td>Maintain code on GitHub</td><td>released</td></tr><tr class="table-even"><td>July 2012</td><td>Documentation of object repository design</td><td>released</td></tr><tr class="table-odd"><td>July - November 2012 (August Vacation period)</td><td>Derivative production for video</td><td>released</td></tr><tr class="table-even"><td>July - November 2012 (August Vacation period)</td><td>Derivative production for audio</td><td>released</td></tr><tr class="table-odd"><td>July 2012</td><td>oauth2 administrative Interface</td><td>released</td></tr><tr class="table-even"><td>July 2012</td><td>Captcha to administrative Interface</td><td>delayed</td></tr><tr class="table-odd"><td>July 2012</td><td>Add IPv6 compatibility to Infrastructure and software</td><td>released</td></tr><tr class="table-even"><td>July 2012</td><td>Maintain and support helpdesk</td><td>released</td></tr><tr class="table-odd"><td>July 2012</td><td>Documenting the Object repository infrastructure</td><td>released</td></tr><tr class="table-even"><td>September 2012</td><td>Content and usage statistics</td><td>released</td></tr><tr class="table-odd"><td>November 2012</td><td>Secure Key-based delivery of content ( e.g. for webshop and other external clients )</td><td>released</td></tr><tr class="table-even"><td>September 2012</td><td>‘delete-files’ and/or ‘delete-collections’</td><td>released</td></tr><tr class="table-odd"><td>December 2012</td><td>Documentation on how to setup the object repository</td><td>pending</td></tr><tr class="table-even"><td>January 2013</td><td>Add METSmaker</td><td>moved to other project</td></tr><tr class="table-odd"><td>February 2013</td><td>METS to pdf converter</td><td>released</td></tr><tr class="table-even"><td>April 2013</td><td>guest ftp accounts</td><td>pending</td></tr></table>


<h2 id="roadmap">1.3 Roadmap</h2>
<h3>Integrity assurance service</h3>
The object-repository needs a further integrity validation of stored master material. This involves random checksum
calculations on files.<p class="paragraph"/><h3>Auto-reparations</h3>
When file degradation is detected reparations should be performed using the replicas; or master.<p class="paragraph"/><h3>File identification and validation service</h3>
A service that invokes Fido and DROID for file identification to assist determining and verifying a given content type.<p class="paragraph"/><h4>OCR, data mining and entity recognition</h4>


<h1 id="architecture">2 Architecture</h1>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture.gdoc


<h2 id="architectureWorkflowService">2.1 Workflow services</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureWorkflowService.gdoc


<h2 id="architectureWorkflowServiceInitiate">2.1.1 Initiate</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureWorkflowService/architectureWorkflowServiceInitiate.gdoc


<h2 id="architectureWorkflowServiceActive">2.1.2 Active</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureWorkflowService/architectureWorkflowServiceActive.gdoc


<h2 id="architectureWorkflowServiceRetire">2.1.3 End</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureWorkflowService/architectureWorkflowServiceRetire.gdoc


<h2 id="architectureMessageQueue">2.2 Message queue producer</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureMessageQueue.gdoc


<h2 id="architectureMessageQueueInstruction">2.2.1 Processing instruction consumer</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureMessageQueueInstruction.gdoc


<h2 id="architectureMessageQueueIngest">2.2.2 Ingest consumer</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureMessageQueueIngest.gdoc


<h2 id="architectureMessageQueueDerivative">2.2.3 Derivative consumer</h2>
/home/lwo/object-repository/object-repository-admin/src/docs/guide/architecture/architectureMessageQueueDerivative.gdoc


<h2 id="architectureMessageQueuePidWebservice">2.2.4 PID consumer</h2>



<h1 id="stagingarea">3 Staging area</h1>
The staging area is a work space where you can assemble your ingest package. Here you:
<ul class="star">
<li>use ftp to upload files to temporary storage and rearrange these</li>
<li>optionally upload a XML processing instruction</li>
<li>optionally upload derivative material</li>
</ul><p class="paragraph"/>


<h2 id="ftp">3.1 FTP</h2>
To connect to the staging area you need one or more ftp accounts which a CP administrator can via with the <a href="../guide/single.html#user" class="guide">Accounts section</a>.
at the administrator interface.<p class="paragraph"/><a href="http://filezilla-project.org/download.php?type=client" target="blank">FileZilla</a> and <a href="http://winscp.net/eng/download.php" target="blank">WinSCP</a> are known to work well
with the staging area. To make a connection:
<ul class="star">
<li>create an ftp-account</li>
<li>set the host name of the staging area to the one mentioned in the ftp account confirmation e-mail</li>
<li>set the ftp client to support an <strong class="bold"></strong>explicit FTP over TLS<strong class="bold"></strong> connection</li>
<li>enable <strong class="bold"></strong>passive mode<strong class="bold"></strong>.</li>
<li>The ftp port to use is the default 21.</li>
</ul><p class="paragraph"/>As a rule (and avoid confusion) use the CP user account to upload files and XML processing instructions with. Not your
CP administrator account.



<h2 id="datasets">3.2 Datasets</h2>
After a CP user (of course, ftp procedures can be automated also) logs in with a ftp-account, the first directory visible
is the <strong class="bold"></strong>home directory<strong class="bold"></strong>. A FTP client will show this as a "/".<p class="paragraph"/>The user should at least upload one <strong class="bold"></strong>main folder<strong class="bold"></strong> containing files (your dataset) in the
home directory. This example illustrates the upload of a main folder called "unittest" and it contains 5 files.<p class="paragraph"/><img border="0" class="center" src="../img/fileset.gif"></img><p class="paragraph"/><blockquote class="note">Any folder or file that starts with a dot, will be ignored by the ingest procedures.
Also any digital file placed right in the home directory and not in a main folder will be ignored.</blockquote><p class="paragraph"/>See there are 10 files ? For each file you upload to the staging area, the FTP server produces a md5 checksum. This is
 stored next to the file in the format <code>filename.md5</code>. The checksum it contains is compared the one you
deliver in a <a href="../guide/single.html#instruction" class="guide">processing instruction</a> in order to assert integrity. It contains something like this:
<div class="code"><pre>181c838e29cbb0602da4a160eece2217  1.1.tif</pre></div><p class="paragraph"/><blockquote class="note">
You should not delete automatically created md5 files. If you do; the ingest of your files can take a long time.
</blockquote>



<h2 id="customderivatives">3.3 Your own derivatives</h2>
The object-repository has a service to create lower level copies of the masters.<p class="paragraph"/>It attempts to create three levels for images and first page pdf documents:
<ul class="star">
<li>level 1: high print quality</li>
<li>level 2: medium screen quality</li>
<li>level 3: small, thumbnail quality</li>
</ul><p class="paragraph"/>For audio:
<ul class="star">
<li>level 1: high quality mp3</li>
</ul><p class="paragraph"/>For video:
<ul class="star">
<li>level 1: high quality h264 AAC (mp4) movie</li>
<li>level 2: montage of 16 stills taken from the entire movie's range</li>
<li>level 3: small, thumbnail quality taken from the middle of the movie</li>
</ul><p class="paragraph"/>If you want you can add your own derivative material because it is of better quality or the type of derivative
manufacturing is not supported.<p class="paragraph"/><h3>Conventional offerings</h3>
The position and names of the derivatives must follow conventions:
<ul class="star">
<li>the root folder in which the derivative is placed must be called ".level1" or ".level2" or ".level3". Notice they</li>
</ul><p class="paragraph"/>start with a dot.
<ul class="star">
<li>the derivative filename must be identical ( case sensitive ) to that of the master filename - excluding the file</li>
</ul><p class="paragraph"/>extension. For example
if the master is called <code>MyFile.tiff</code> or <code>BigVideo.mpg</code> then the custom derivative must be positioned and named like
<code>/.level1/MyFile.jpg</code> or <code>/.level2/BigVideo.mpg</code>
<ul class="star">
<li>the derivative must be parallel to the master file.</li>
<li>the extension of the derivative must be related to a known contenttype as <a href="../ref/Httpsgithubcom IISH objectrepositoryscriptsblobmastersharedcontenttypetxt/indicated in this list.html" class="https://github.com/IISH/object-repository-scripts/blob/master/shared/contenttype.txt">indicated in this list</a>. If you see that your derivative extension is not in this list, then make a feature request.</li>
</ul><p class="paragraph"/>A few examples will clarify the points just made.<p class="paragraph"/><h4>Example 1</h4>
A master is placed deep within some subfolders: <code>/main_folder/b/c/d/myLargeFile.tiff</code>
And the derivative file is called <code>myLargeFile.png</code><p class="paragraph"/>Then a level1 derivative can be placed anywhere by <strong class="bold">inserting</strong> a <strong class="bold">.level1</strong> folder thus:
<ul class="star">
<li><code>/main_folder/b/c/d/.level1/myLargeFile.png</code></li>
<li><code>/main_folder/b/c/.level1/myLargeFile.png</code></li>
<li><code>/main_folder/b/.level1/d/myLargeFile.png</code></li>
<li><code>/main_folder/.level1/c/d/myLargeFile.png</code></li>
</ul><p class="paragraph"/>Or by <strong class="bold">substituting</strong> a folder so:
<ul class="star">
<li><code>/main_folder/b/c/.level1/myLargeFile.png</code></li>
<li><code>/main_folder/b/.level1/d/myLargeFile.png</code></li>
<li><code>/main_folder/.level1/c/d/myLargeFile.png</code></li>
</ul><p class="paragraph"/><h4>Example 2</h4>
A master is placed in the main folder <code>/mydataset/myVeryLargeMovie.mpg</code>
Then we offer both level1, level2 and a level3 file like this:
<ul class="star">
<li><code>/mydataset/.level1/myVeryLargeMovie.mpg</code></li>
<li><code>/mydataset/.level2/myVeryLargeMovie.mpg</code></li>
<li><code>/mydataset/.level3/myVeryLargeMovie.mpg</code></li>
</ul><p class="paragraph"/><blockquote class="note">The derivative service will first look a custom derivative. If it does not find a one, it will attempt to produce it</blockquote><p class="paragraph"/><h4>Supplying derivatives some time after an ingest</h4>
To add custom derivatives after the ingest is completed, you follow the same procedure:
<ul class="star">
<li>upload your custom derivative files according to the location convention</li>
<li>in case your instruction gives validation warnings on absent master locations: disable and save the plan's master and</li>
</ul><p class="paragraph"/>any other non-related derivative tasks. Then validate the instruction
<ul class="star">
<li>Start processing your files.</li>
</ul><p class="paragraph"/> Should you have deleted your instruction, then either recreate it from the Stored objects menu. Or
 reupload a new one which should contain the location elements from which the custom derivative
 can be found.<p class="paragraph"/> <blockquote class="note">In case you reupload for the sake of ingesting custom derivatives, the location element
 need not be the same as the original master files from a previous instruction.</blockquote>


<h1 id="readonlyftp">4 Download files using ftp</h1>
Just like the stagingarea where you upload files using ftp;
you can download ingested files using ftp as well.<p class="paragraph"/><a href="http://filezilla-project.org/download.php?type=client" target="blank">FileZilla</a> and <a href="http://winscp.net/eng/download.php" target="blank">WinSCP</a> are
ftp clients you can use. Or any other for that matter, provided you use these settings:
<ul class="star">
<li>connect to ftp.objectrepository.org</li>
<li>set the ftp client to support an <strong class="bold"></strong>implicit FTP over TLS<strong class="bold"></strong> connection</li>
<li>enable <strong class="bold"></strong>passive mode<strong class="bold"></strong>.</li>
<li>your account is the same account with which you administer your object repository.</li>
</ul><p class="paragraph"/>The ftp home directory will represent files in the same way as the masters were ingested. There is a folder for
 each of the stored master and it's derivatives there:
<div class="code"><pre>/master
/level1
/level2
/level3</pre></div><p class="paragraph"/>The directory tree is similar to the way files are offered to the staging area at ingest time.



<h1 id="instruction">5 Prepare the ingest</h1>
The administration interface and an XML processing instruction together makes it all work.
An instruction has required and optional values. Those values can be set at three levels:<p class="paragraph"/><h4>1. Profile</h4>
Via the administration interface select <a href="../guide/single.html#profile" class="guide">profile</a>. Default <a href="../guide/single.html#settings" class="guide">instruction settings</a> can be
placed there by a CP administrator. It makes sense therefore, to set all your broad access policies and most frequently
used file content values here. Settings in the profile substitute any absent values in the XML processing instruction.<p class="paragraph"/><h4>2. instruction.xml</h4>
The instruction.xml is a XML document. It's main element is named <code>instruction</code> and contains attributes identical to
those you set in the profile. Any setting here will override those in the profile. Typically you would set values that
are exceptions to the more global general situation.<p class="paragraph"/>Each main folder ought to contain an XML document. However with automated creation of instructions you need no XML.<p class="paragraph"/><h4>3. Stagingfile</h4>
In the instruction.xml's child elements one should mention <code>stagingfile</code> elements. A stagingfile element represents the
file and any settings here will override those in the main element and profile.<p class="paragraph"/>The stagingfile is the only element that has some unique settings not present in the profile or instruction, such as md5,
location and pid value.<p class="paragraph"/>In short
Profile settings provide reasonable defaults for an organizations processing instruction.
Instruction settings in an instruction.xml document override profile values and provide specific defaults for
stagingfiles.
Stagingfile settings in their final turn override instruction and profile settings. The smallest always win.<p class="paragraph"/>



<h2 id="settings">5.1 Instruction settings</h2>
You can manage the ingest of your files by setting the instruction's elements. As these configurations can be placed
at different levels ( profile's, XML instruction's and stagingfile's ) we mention that between brackets.<p class="paragraph"/><h3>To begin with: a friendly description</h3>
<code>label</code> (profile and instruction element)<p class="paragraph"/>A human readable bit of information. This will show up on the administration
interface when viewing your instructions.<p class="paragraph"/><h3>Plan the services</h3>
<code>plan</code> (profile and instruction)<p class="paragraph"/>Determines what services are to be used ( in no particular order ). Seperated by a comma.<p class="paragraph"/>To tell you want a master ingest or update:
<div class="code"><pre>plan='StagingfileIngestMaster'</pre></div><p class="paragraph"/>To call the PID webservice:
<div class="code"><pre>plan='StagingFileBindPIDs'</pre></div>
This will invoke the PID webservice to bind the PIDs to the resolve url's of the object repository. One must have
an account at a PID webservice and have the <code>pidwebserviceEndpoint</code> and <code>pidwebserviceKey</code> set.<p class="paragraph"/>To produce derivatives:
<ul class="star">
<li>@plan='StagingfileIngestLevel1'</li>
<li>@plan='StagingfileIngestLevel2'</li>
<li>@plan='StagingfileIngestLevel3'</li>
</ul><p class="paragraph"/>If left empty, the default is to use all the services. This is equivalent to adding the following in an XML instruction:
<div class="code"><pre>plan='StagingfileIngestMaster,StagingFileBindPIDs,StagingfileIngestLevel1,StagingfileIngestLevel2,StagingfileIngestLevel3'</pre></div><p class="paragraph"/><h3>Additions and updates</h3>
<code>action</code> (profile, instruction and stagingfile elements)<p class="paragraph"/>This controls how the ingest and dissemination procedures handles the file. The default 'upsert' is the most simple
to use as it covers most use cases.<p class="paragraph"/>    <div class="code"><pre>action='upsert' ( <span class="java&#45;keyword">default</span> )</pre></div>
    Adds the file with the given pid. If a file with the pid already exists, it will be updated with the new file.<p class="paragraph"/>    <div class="code"><pre>action='add'</pre></div>
    Add a file with the given pid. But error will occur when the pid already exists in the object repository<p class="paragraph"/>    <div class="code"><pre>action='update'</pre></div>
    Updates a file with the given pid. But error will occur if the pid does not exists in the object repository<p class="paragraph"/>    <div class="code"><pre>action='delete'</pre></div>
    Removes the file with the specified PID. In this version of the object-repository the delete action does not remove
    a file. Rather it sets the access value to 'deleted' and makes the digital object unavailable this way.<p class="paragraph"/><h3>Access policy</h3>
<code>access</code> (profile, instruction and stagingfile elements)<p class="paragraph"/>Determines which dissemination policy to use when anonymous users want to view a level1, level2 or level3 derivative.
There are three out-of-the-box policies available:<p class="paragraph"/>    All derivatives are viewable to the world:
    <div class="code"><pre>access='open'</pre></div><p class="paragraph"/>    Level 1 is restricted; level 2 and 3 are viewable to the world
    <div class="code"><pre>access='restricted'</pre></div><p class="paragraph"/>    no files can be downloaded or viewed
    <div class="code"><pre>access='closed' (<span class="java&#45;keyword">default</span>)</pre></div><p class="paragraph"/>In the administration interface a CP administrator can add new policies and thus apply custom view levels.<p class="paragraph"/><h3>The compound object identifier and ordering of files</h3>
<code>objid</code> (instruction, stagingfile; empty by default)<p class="paragraph"/>Groups all the files declared the instruction; stating they all belong to the same compound.
The syntax of this file is the same as any PID element.<p class="paragraph"/><code>seq</code> (stagingfile; 1 by default)
Typically when using the objid; you would express the order for each stagingfile with the <code>seq</code> element. If you
do not specify the order; the alphabetical ordering of your staged files will determine that sequence value.<p class="paragraph"/><code>pdfLevel</code> ( profile, instruction; 'level2' by default )
Determines which derivative level shall be used to render a PDF with. This level must consist of images.<p class="paragraph"/><h3>Mimetype</h3>
<code>contentType</code> (profile, instruction and stagingfile elements)<p class="paragraph"/>The value indicates the nature of the file ( like "image/jpeg", "application/pdf , etc)<p class="paragraph"/><blockquote class="note">Make sure your mimetype is correct or else the derivative creation or rendering may not go quite according to plan.</blockquote>
For more on mimetypes see:
<ul class="star">
<li><a href="http://en.wikipedia.org/wiki/MIME" target="blank">http://en.wikipedia.org/wiki/MIME</a></li>
<li>some good examples at <a href="http://www.ltsw.se/knbase/internet/mime.htp" target="blank">http://www.ltsw.se/knbase/internet/mime.htp</a></li>
<li>The object-repository has a list at <a href="../ref/Httpsgithubcom IISH objectrepositoryscriptsblobmastersharedcontenttypetxt/https://github.com/IISH/object-repository-scripts/blob/master/shared/contenttype.txt.html" class="https://github.com/IISH/object-repository-scripts/blob/master/shared/contenttype.txt">https://github.com/IISH/object-repository-scripts/blob/master/shared/contenttype.txt</a> of content types.</li>
</ul><p class="paragraph"/><h3>Checksum</h3>
<code>md5</code> (stagingfile element)<p class="paragraph"/>Used to determine if the transport from one place to another (the staging area; the document database) was in deed
without flaw.<p class="paragraph"/><h3>File location</h3>
<code>location</code> (stagingfile element)<p class="paragraph"/>The case sensitive path and filename of the digital file. The beginning of the path is the same as the home directory.<p class="paragraph"/><h3>The persistent identifier</h3>
<code>pid</code> (stagingfile element)<p class="paragraph"/>The object-repository needs the PID (e.g. a piece of string that can be resolved via Handle System, Ark, DOI) without the base URL, for example like:
<div class="code"><pre>&#60;pid&#62;12345/mypid&#60;/pid&#62;
&#60;pid&#62;hdl:12345/mypid&#60;/pid&#62;
&#60;pid&#62;ark:/12345/654xz321&#60;/pid&#62;
&#60;pid&#62;10.12345/jmbi.1998.2354&#60;/pid&#62;
&#60;pid&#62;doi:10.12345/jmbi.1998.2354&#60;/pid&#62;</pre></div><p class="paragraph"/><blockquote class="note">When unable to provide a pid value, use the optional substitute <code>lid</code> stagingfile element.</blockquote><p class="paragraph"/><h3>Set a PID resolver base url</h3>
<code>resolverBaseUrl</code> (profile and instruction element)<p class="paragraph"/>The resolver is a website that will know what to do with the PID. So if the PID is attached to the resolverBaseUrl we
ought to have a complete, workable url. This is used at the dissemination end of the object-repository to offer a link
for the enduser.<p class="paragraph"/>For example, for
<code>&#60;pid&#62;12345/mypid&#60;/pid&#62;</code>
and
<code>resolverBaseUrl='http://hdl.handle.net/'</code><p class="paragraph"/>the complete link on the dissemination interface would become: <code>http://hdl.handle.net/12345/mypid</code><p class="paragraph"/><h3>The optional 'lid' identifier</h3>
This element is a system (your local organization's system that is ) wide unique identifier. For example a LIS number or
database key. Usage of this substitute is only needed if you are unable to supply and manage your own PIDs. You ought to
have a PID webservice account to use the LID-PID substitute.<p class="paragraph"/>When you submit a LID; the PID webservice will generate a PID value and insert it into the instruction. Any update
afterwards with the same LID will return this PID.<p class="paragraph"/><h3>The PID webservice</h3>
<code>pidwebserviceEndpoint</code>: the endpoint or url of a PID webservice<p class="paragraph"/><code>pidwebserviceKey</code>: the webservice key that belongs to your account at the PID webservice<p class="paragraph"/>These two settings combined are required to bind the PIDs to the object-repository's resolve URLs.<p class="paragraph"/><h3>Automated PID creation</h3>
<code>autoGeneratePIDs</code> (profile and instruction element)<p class="paragraph"/>Is trickered by the administration interface <code>autoCreate instruction</code> and <code>upload instruction</code> commands.<p class="paragraph"/>    <div class="code"><pre>autoGeneratePIDs='none' (<span class="java&#45;keyword">default</span>)</pre></div>
    Wont do anything for an absent pid element<p class="paragraph"/>    <div class="code"><pre>autoGeneratePIDs='uuid'</pre></div>
    The system will provide an empty PID element with a seemingly random string.
    Example: <code>&#60;pid&#62;12345/10997FB2-1BFD-4191-A7E2-1AA1308960BB&#60;/pid&#62;</code><p class="paragraph"/>    <div class="code"><pre>autoGeneratePIDs='filename2pid'</pre></div>
    Substitute an empty PID element with the filename ( without suffix ).
    example: <code>MyLargeFile.tif</code> will lead to <code>&#60;pid&#62;12345/MyLargeFile&#60;/pid&#62;</code><p class="paragraph"/>    <div class="code"><pre>autoGeneratePIDs='filename2lid'</pre></div>
    Substitute an empty lid element with the filename ( without suffix ).
    example: <code>MyLargeFile.tif</code> will lead to <code>&#60;lid&#62;12345/MyLargeFile&#60;/lid&#62;</code><p class="paragraph"/>    <div class="code"><pre>autoGeneratePIDs='lid'</pre></div>
    Ignore an empty PID setting during auto creation and validation as long as it has a LID element<p class="paragraph"/><h3>Automatic ingest ( for automated batch procedures )</h3>
<code>autoIngestValidInstruction</code> (profile and instruction element)<p class="paragraph"/>If set to <div class="code"><pre>autoIngestValidInstruction='<span class="java&#45;keyword">true</span>'</pre></div> will start an instruction process. But only if the instruction that was
uploaded or automatically generated is valid.<p class="paragraph"/>Typically this is useful for batch procedures that involve automated FTP uploads of files and processing instructions.<p class="paragraph"/><h3>Replacing derivatives</h3>
<code>replaceExistingDerivatives</code> (profile, instruction and stagingfile element)
Used in combination with a plan that creates derivatives.
When set to false ( default ) your derivatives will be replaced by newly master converted ones.<p class="paragraph"/><blockquote class="note">Custom derivatives will always be ingested, regardless of this setting.</blockquote><p class="paragraph"/><h3>E-mail notifications</h3>
<code>notificationEMail</code>
This value is a comma delimited list of e-mail addresses. When an instruction is completed, it will sent a message
 to those e-mails<p class="paragraph"/>


<h2 id="xmlinstruction">5.2 The XML instruction</h2>
A XML processing instruction should be:
<ul class="star">
<li>named <code>instruction.xml</code></li>
<li>placed in the main folder of the uploaded dataset.</li>
</ul><p class="paragraph"/>For example if you uploaded these five files onto the staging area in the main folder <code>unittest</code> then you must add the
instruction in the folder <code>unittest</code> as well:
<img border="0" class="center" src="../img/filesetxml.gif"></img><p class="paragraph"/>This file will be deleted automatically after you uploaded it, as it is read into a database. You can re upload the
instruction any time you want. Or download it from the database back to your local PC or the staging area main folder
using the administration panel.<p class="paragraph"/><a href="../ref/Httpsrawgithubcom IISH objectrepositoryservicenodesmastercoresrcmainresourcesinstructionv10xsd/The schema can be found here.html" class="https://raw.github.com/IISH/object-repository-servicenodes/master/core/src/main/resources/instruction.v1.0.xsd">The schema can be found here</a><p class="paragraph"/><blockquote class="note">When you download a XML processing instruction, it may have added validation messages.</blockquote><p class="paragraph"/><h3>Working example of an XML instruction</h3>
Lets say we automatically create an instruction via the administration panel for the five files we just uploaded.
On the <a href="../guide/single.html#administration" class="guide">instructions page</a> we edit the settings and indicate the following:
<table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">element</strong></th><th><strong class="bold">value</strong></th></tr><tr class="table-odd"><td>Label</td><td>My five files</td></tr><tr class="table-even"><td>Action</td><td>upsert</td></tr><tr class="table-odd"><td>Access</td><td>open</td></tr><tr class="table-even"><td>Contenttype&#77;imetype</td><td>image/tiff</td></tr><tr class="table-odd"><td>Auto generate PIDs</td><td>filename2pid</td></tr><tr class="table-even"><td>Auto ingest valid instructions : off</td></tr><tr class="table-odd"><td>Resolver baseUrl</td><td>http://hdl.handle.net/</td></tr><tr class="table-even"><td>Service to execute</td><td>all</td></tr></table><p class="paragraph"/>After we press "update" we can download the XML for viewing:
<div class="code"><pre>&#60;?xml version=<span class="java&#45;quote">"1.0"</span> encoding=<span class="java&#45;quote">"utf&#45;8"</span>?&#62;
&#60;!&#45;&#45;Instruction extracted on 11 Jun 2012 11:05:15 GMT&#45;&#45;&#62;
&#60;instruction xmlns=<span class="java&#45;quote">"http://objectrepository.org/instruction/1.0/"</span>
    access=<span class="java&#45;quote">"open"</span>
    action=<span class="java&#45;quote">"upsert"</span>
    autoGeneratePIDs=<span class="java&#45;quote">"filename2pid"</span>
    contentType=<span class="java&#45;quote">"image/tiff"</span>
    label=<span class="java&#45;quote">"My five files"</span>
    resolverBaseUrl=<span class="java&#45;quote">"http://hdl.handle.net/"</span>&#62;
    &#60;stagingfile&#62;
        &#60;pid&#62;12345/1.1&#60;/pid&#62;
            &#60;location&#62;/unittest/TIFF/1.1.tif&#60;/location&#62;
            &#60;md5&#62;181c838e29cbb0602da4a160eece2217&#60;/md5&#62;
    &#60;/stagingfile&#62;
    &#60;stagingfile&#62;
            &#60;pid&#62;12345/1.3&#60;/pid&#62;
            &#60;location&#62;/unittest/TIFF/1.3.tif&#60;/location&#62;
            &#60;md5&#62;efac78a3f9bc224b581bd9e6003813e3&#60;/md5&#62;
    &#60;/stagingfile&#62;
    &#60;stagingfile&#62;
            &#60;pid&#62;12345/1.4&#60;/pid&#62;
            &#60;location&#62;/unittest/TIFF/1.4.tif&#60;/location&#62;
            &#60;md5&#62;b2d09024f5c5c9b823ec614a7d7bc8d0&#60;/md5&#62;
    &#60;/stagingfile&#62;
    &#60;stagingfile&#62;
            &#60;pid&#62;12345/1.5&#60;/pid&#62;
            &#60;location&#62;/unittest/TIFF/1.5.tif&#60;/location&#62;
            &#60;md5&#62;4daae1f298383d440f725f195621cebf&#60;/md5&#62;
            &#60;/stagingfile&#62;
    &#60;stagingfile&#62;
            &#60;pid&#62;12345/1.2&#60;/pid&#62;
            &#60;location&#62;/unittest/TIFF/1.2.tif&#60;/location&#62;
            &#60;md5&#62;5eaea136b6e49f2dabff2f8f1a278d7c&#60;/md5&#62;
    &#60;/stagingfile&#62;
&#60;/instruction&#62;</pre></div><p class="paragraph"/><h3>Validation</h3>
An automatic validation procedure will run the moment you <code>autocreate</code> an instruction or ftp one into the main folder.
The results of the validation will show up in the CP administration interface per instruction and per file. In addition,
downloading the file via the CP administration interface will give you the XML instruction with <code>error</code> elements if any.
After you correct the issue, you can reupload the XML processing instruction and files where needed.<p class="paragraph"/>The validation will look for a number of issues:
<ul class="star">
<li>all files in the main folder must be in the instruction</li>
<li>all stagingfile elements in the instruction must be found the main folder content</li>
<li>the md5 checksum values must match</li>
<li>a PID ( or lid substitute ) must be present</li>
<li>the PID or LID values may not occur elsewhere in the instruction</li>
<li>a file cannot be zero bytes in length</li>
</ul><p class="paragraph"/><h3>Viewing and changing the XML instruction after upload</h3>
All the uploaded datasets's main folders are visible at the <a href="../guide/single.html#administration" class="guide">instructions page</a> of the administration
interface. There the instructions and stagingfile elements can be tweaked. This feature is locked after ingest.<p class="paragraph"/><h3>Question: Should I automatically create an XML processing instruction?</h3>
It can be useful when you make your own custom instructions. You can use this feature to experiment to see how a
valid instruction looks like.<p class="paragraph"/>Should your PID or LID values be identical to the filenames, you could produce an instruction that is perfect for
ingest.<p class="paragraph"/>
<h3>Two more examples of an XML processing instruction</h3><p class="paragraph"/><h4>Example with pid elements.</h4>
Lets us assume a folder structure of one main folder with five files<p class="paragraph"/>    <div class="code"><pre>home&#45;directory: /
        /folderA
        /folderA/Apple.tiff
        /folderA/Pear.tiff
        /folderA/Banana.tiff
        /folderA/Potato.png
        /folderA/SecretRecipe.tiff</pre></div><p class="paragraph"/>And to stretch the borders of our imagination a little further, suppose the CP administrator has set the following
default settings in the profile via the administration interface:<p class="paragraph"/>    <div class="code"><pre>action=upsert
    access=closed
    contentType=image/tiff</pre></div><p class="paragraph"/>Now we can mostly fall back on the defaults the profile provides, but we do want to add some exceptions to the
profile rules by adding new values the XML processing instruction:
<ol>
<li>Notice the <code>contentType</code> for the potato ? It is not a tiff but an <strong class="bold">image/png</strong>.</li>
</ol><p class="paragraph"/>2. And we feel the <code>access</code> of the policy is too strict. Lets set it all to <strong class="bold">open</strong>.
3. And lets set the <code>access</code> to SecretRecipe.tiff to <strong class="bold">restricted</strong>.<p class="paragraph"/>The processing instruction would then could look like this:<p class="paragraph"/>   <div class="code"><pre>&#60;?xml version=<span class="java&#45;quote">"1.0"</span> encoding=<span class="java&#45;quote">"UTF&#45;8"</span> standalone=<span class="java&#45;quote">"yes"</span>?&#62;
    &#60;instruction xmlns=<span class="java&#45;quote">"http://objectrepository.org/instruction/1.0/"</span> access=<span class="java&#45;quote">"open"</span>&#62; &#60;!&#45;&#45; access added here &#45;&#45;&#62;
        &#60;stagingfile&#62;
            &#60;pid&#62;12345/a&#60;/pid&#62;
            &#60;location&#62;/folderA/Apple.tiff&#60;/location&#62;
            &#60;md5&#62;cf3ee1101d19328145e94da1cade45bd&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;pid&#62;12345/b&#60;/pid&#62;
            &#60;location&#62;/folderA/Pear.tiff&#60;/location&#62;
            &#60;md5&#62;f57eb0e65d11a5a73eab9d5dddf1e528&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;pid&#62;12345/c&#60;/pid&#62;
            &#60;location&#62;/folderA/Banana.tiff&#60;/location&#62;
            &#60;md5&#62;c741cd201fafb15c5ec874ae16738671&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;contentType&#62;image/png&#60;/contentType&#62; &#60;!&#45;&#45; contentType here &#45;&#45;&#62;
            &#60;pid&#62;12345/d&#60;/pid&#62;
            &#60;location&#62;/folderA/Potato.png&#60;/location&#62;
            &#60;md5&#62;c741cd201fafb15c5ec874ae16738671&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;access&#62;restricted&#60;/access&#62; &#60;!&#45;&#45; access element here &#45;&#45;&#62;
            &#60;pid&#62;12345/e&#60;/pid&#62;
            &#60;location&#62;/folderA/SecretRecipe.tiff&#60;/location&#62;
            &#60;md5&#62;c741cd201fafb15c5ec874ae16738671&#60;/md5&#62;
        &#60;/stagingfile&#62;
    &#60;/instruction&#62;</pre></div><p class="paragraph"/><h4>Example with lid elements</h4>
As a second example, lets suggest you are a content provider that can not supply persistent identifiers but only supply
local identifiers. Lets also assume that you made things easy and the local identifiers can be derived from the filenames
but without the extension. Here we can automatically create an instruction.<p class="paragraph"/><blockquote class="note">this example would only work in the object repository when it can fall back on a Handle System compatible PID
webservice for which a naming authority is required. In the example we assume this so and the authority is 12345.</blockquote><p class="paragraph"/>Lets say these are the files in the staging area:<p class="paragraph"/>    <div class="code"><pre>home&#45;directory: /
        /folderA
        /folderA/Apple.tiff
        /folderA/Pear.tiff
        /folderA/Banana.tiff
        /folderA/Potato.tiff
        /folderA/FreeRecipe.tiff</pre></div><p class="paragraph"/>And we have set our profile defaults via the administration interface thus:<p class="paragraph"/>    <div class="code"><pre>action=upsert
    access=closed
    contentType=image/tiff
    autoGeneratePIDs='filename2lid'</pre></div><p class="paragraph"/>Via the administration interface "instruction" tab, you can now press the autocreate button.<p class="paragraph"/>Alternatively, you could have created the XML instruction yourself so:<p class="paragraph"/>    <div class="code"><pre>&#60;?xml version=<span class="java&#45;quote">"1.0"</span> encoding=<span class="java&#45;quote">"UTF&#45;8"</span> standalone=<span class="java&#45;quote">"yes"</span>?&#62;
    &#60;instruction xmlns=<span class="java&#45;quote">"http://objectrepository.org/instruction/1.0/"</span>&#62;
        &#60;stagingfile&#62;
            &#60;lid&#62;12345/Apple&#60;/lid&#62;
            &#60;location&#62;/folderA/Apple.tiff&#60;/location&#62;
            &#60;md5&#62;cf3ee1101d19328145e94da1cade45bd&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;lid&#62;12345/Pear&#60;/lid&#62;
            &#60;location&#62;/folderA/Pear.tiff&#60;/location&#62;
            &#60;md5&#62;f57eb0e65d11a5a73eab9d5dddf1e528&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;lid&#62;12345/Banana&#60;/lid&#62;
            &#60;location&#62;/folderA/Banana.tiff&#60;/location&#62;
            &#60;md5&#62;c741cd201fafb15c5ec874ae16738671&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;lid&#62;12345/Potato&#60;/lid&#62;
            &#60;location&#62;/folderA/Potato.tiff&#60;/location&#62;
            &#60;md5&#62;c741cd201fafb15c5ec874ae16738671&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;lid&#62;12345/FreeRecipe&#60;/lid&#62;
            &#60;location&#62;/folderA/FreeRecipe.tiff&#60;/location&#62;
            &#60;md5&#62;d241cd201fafb15c5ec874ae167386ee&#60;/md5&#62;
        &#60;/stagingfile&#62;
    &#60;/instruction&#62;</pre></div>


<h2 id="running">5.3 Starting\run an instruction</h2>
Starting an instruction can be automated, provided the conditions are right:
<ul class="star">
<li>a FTP client has uploaded files</li>
<li>a valid XML processing instruction is in a main folder</li>
<li>If you had set the element ( in either the XML document itself or if not, at the profile panel ) :</li>
</ul><p class="paragraph"/><div class="code"><pre>autoIngestValidInstruction=<span class="java&#45;keyword">true</span></pre></div><p class="paragraph"/>In those cased the ingest of your files will start by itself.
This is the same for instructions that were automatically created using this setting.<p class="paragraph"/>If you disable <code>autoIngestValidInstruction</code>, then a start needs a manual command. From the administration interface
select <code>Process instruction</code> to start.<p class="paragraph"/>{Note}The manual option to Process an instruction will not appear until the instruction is considered valid.{Note}


<h1 id="pid">6 PIDs and the repository's resolve urls</h1>
Persistent identifiers can be created and bound via an object-repository service that calls the PID webservice.
In other cases you can operate your own PID and resolver technology and point to resources that are exposed by the
repository.<p class="paragraph"/>The object repository will bind PIDs for:
<ul class="star">
<li>files</li>
<li>compound objects</li>
</ul><p class="paragraph"/>


<h2 id="resolveurls">6.1 Resolve URLs</h2>
For each master and derivative there is a resolve url. The PID of the file is part of that url. The convention here
is that the resolve URL = <code>http;//domain-of-the-repository/file/level]/pid</code><p class="paragraph"/>For example, if this was your PID: <code>12345/1.1</code><p class="paragraph"/>And you created a level1, level2 and level3 derivative, then there are five resolve URLs in total to link to:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">view</strong></th><th><strong class="bold">Resolve Url</strong></th></tr><tr class="table-odd"><td>metadata</td><td>http://disseminate.objectrepository.org/metadata/12345/1.1</td></tr><tr class="table-even"><td>master</td><td>http://disseminate.objectrepository.org/file/master/12345/1.1</td></tr><tr class="table-odd"><td>level 1</td><td>http://disseminate.objectrepository.org/file/level1/12345/1.1</td></tr><tr class="table-even"><td>level 2</td><td>http://disseminate.objectrepository.org/file/level2/12345/1.1</td></tr><tr class="table-odd"><td>level 3</td><td>http://disseminate.objectrepository.org/file/level3/12345/1.1</td></tr></table><p class="paragraph"/><blockquote class="note">If you create and bind your own PIDs, you know in advance ( before you ingest ) what the resolve URLs are.</blockquote>



<h2 id="pids">6.2 PIDs created via the PID webservice</h2>
<h3>files</h3>
When the StagingfileBindPIDs option was used, a call to the PID webservice will be made to bind the object-repository's
resolve URLs to this PID.<p class="paragraph"/>It will do so by convention:<p class="paragraph"/><code>http://hdl.handle.net/pid?locatt=view:level or master</code><p class="paragraph"/>This means there will be several persistent URLs. For example, if this was your PID: <code>12345/1.1</code> then the persistent
URLs will be:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">view</strong></th><th><strong class="bold">persistent URL</strong></th><th><strong class="bold">Resolve Url</strong></th></tr><tr class="table-odd"><td>metadata</td><td>http://hdl.handle.net/12345/1.1</td><td>http://disseminate.objectrepository.org/metadata/12345/1.1</td></tr><tr class="table-even"><td>master</td><td>http://hdl.handle.net/12345/1.1?locatt=view:master</td><td>http://disseminate.objectrepository.org/file/master/12345/1.1</td></tr><tr class="table-odd"><td>level 1 derivative</td><td>http://hdl.handle.net/12345/1.1?locatt=view:level1</td><td>http://disseminate.objectrepository.org/file/level1/12345/1.1</td></tr><tr class="table-even"><td>level 2 derivative</td><td>http://hdl.handle.net/12345/1.1?locatt=view:level2</td><td>http://disseminate.objectrepository.org/file/level2/12345/1.1</td></tr><tr class="table-odd"><td>level 3 derivative</td><td>http://hdl.handle.net/12345/1.1?locatt=view:level3</td><td>http://disseminate.objectrepository.org/file/level2/12345/1.1</td></tr></table><p class="paragraph"/><h3>compound object identifiers</h3>
When you use an objid the resolve URLs will be different and resolve to the METS document and PDF files. As an
extra feature it will point to the derivative of the first file the compound object consists of:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">view</strong></th><th><strong class="bold">persistent URL</strong></th><th><strong class="bold">Resolve Url</strong></th></tr><tr class="table-odd"><td>mets</td><td>http://hdl.handle.net/12345/my-object-id</td><td>http://disseminate.objectrepository.org/mets/12345/my-object-id</td></tr><tr class="table-even"><td>master</td><td>http://hdl.handle.net/12345/my-object-id?locatt=view:master</td><td>http://disseminate.objectrepository.org/mets/12345/my-object-id</td></tr><tr class="table-odd"><td>pdf</td><td>http://hdl.handle.net/12345/my-object-id?locatt=view:pdf</td><td>http://disseminate.objectrepository.org/pdf/12345/my-object-id</td></tr><tr class="table-even"><td>level 1 derivative</td><td>http://hdl.handle.net/12345/my-object-id?locatt=view:level1</td><td>http://disseminate.objectrepository.org/file/level1/12345/1.1</td></tr><tr class="table-odd"><td>level 2 derivative</td><td>http://hdl.handle.net/12345/my-object-id?locatt=view:level2</td><td>http://disseminate.objectrepository.org/file/level2/12345/1.1</td></tr><tr class="table-even"><td>level 3 derivative</td><td>http://hdl.handle.net/12345/my-object-id?locatt=view:level3</td><td>http://disseminate.objectrepository.org/file/level2/12345/1.1</td></tr></table><p class="paragraph"/>The PDF made here is pointing to:
http://disseminate.objectrepository.org/pdf/12345/my-object-id/<code>pdfLevel</code>
where <code>pidLevel</code> refers to the derivative level of the images that will become the pdf.


<h1 id="compound">7 Compound objects</h1>
Compound objects are abstractions of ordered files. The way you express a compound object is through the processing instruction.
Here you determine:
<ul class="star">
<li>the pid value to refer to a group of files</li>
<li>the physical file order ;</li>
</ul><p class="paragraph"/> This information is used to offer the download of:
<ul class="star">
<li>METS documents</li>
<li>PDFs</li>
</ul><p class="paragraph"/> at the dissemination api or website.


<h2 id="objid">7.1 Object identifiers and file order</h2>
<h3>Expressing objid and order of files</h3>
The compound object has a persistent identifier. In the instruction this is set with the element <strong class="bold">objid</strong>
This is a PID just like the PIDs you supply to identify your files with.<p class="paragraph"/>In addition each individual file in the instruction may be given an order using the element <strong class="bold">seq</strong>.<p class="paragraph"/>As an example, take the situation where you offer a three page letter. You place it onto the staging area:
    <div class="code"><pre>home&#45;directory: /
        /folderA
        /folderA/page_0001.tiff
        /folderA/page_0002.tiff
        /folderA/page_0003.tiff</pre></div><p class="paragraph"/>Object ID and order is expressed this way in an instruction:
<div class="code"><pre>&#60;?xml version=<span class="java&#45;quote">"1.0"</span> encoding=<span class="java&#45;quote">"UTF&#45;8"</span> standalone=<span class="java&#45;quote">"yes"</span>?&#62;
    &#60;instruction xmlns=<span class="java&#45;quote">"http://objectrepository.org/instruction/1.0/"</span> objid=<span class="java&#45;quote">"12345/my&#45;object&#45;id"</span>&#62;
        &#60;stagingfile&#62;
            &#60;pid&#62;12345/my&#45;identifier&#45;a&#60;/pid&#62;
            &#60;seq&#62;1&#60;/seq&#62;
            &#60;location&#62;/folderA/page_00001.tiff&#60;/location&#62;
            &#60;md5&#62;cf3ee1101d19328145e94da1cade45bd&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;pid&#62;12345/my&#45;identifier&#45;b&#60;/pid&#62;
            &#60;seq&#62;2&#60;/seq&#62;
            &#60;location&#62;/folderA/page_00002.tiff&#60;/location&#62;
            &#60;md5&#62;f57eb0e65d11a5a73eab9d5dddf1e528&#60;/md5&#62;
        &#60;/stagingfile&#62;
        &#60;stagingfile&#62;
            &#60;pid&#62;12345/another&#45;identifier&#45;c&#60;/pid&#62;
            &#60;seq&#62;3&#60;/seq&#62;
            &#60;location&#62;/folderA/page_00003.tiff&#60;/location&#62;
            &#60;md5&#62;c741cd201fafb15c5ec874ae16738671&#60;/md5&#62;
        &#60;/stagingfile&#62;
    &#60;/instruction&#62;</pre></div><p class="paragraph"/>If you autocreate an instruction, the seq element is always set in the alphabetical order of the files. An objid
can be set after the autocreate procedure is completed.<p class="paragraph"/><h3>The PID of the objid and it's resolve URLs</h3>
When you offer an objid together with at least one file that has a sequence value of 1, a PID will be declared at
the PID webservice. This pid will refer to:
<ul class="star">
<li>a METS document</li>
<li>a PDF</li>
<li>and to the derivative levels of the very first file.</li>
</ul><p class="paragraph"/>See the <a href="../guide/single.html#pids" class="guide">chapter on the pids</a> what the resolve URLs will become.


<h2 id="mets">7.2 Mets</h2>
The object repository can disseminate the the compound object in a standardized way by exporting a profile level 3 METS document.
Mets is a <a href="http://www.loc.gov/standards/mets/" target="blank">metadata standard of the Library of Congres</a>.<p class="paragraph"/>The dissemination URL of a mets document is:
http://disseminate.objectrepository.org/mets/12345/my-object-id<p class="paragraph"/>The XML it produces would be similar to:
<div class="code"><pre>&#60;?xml version=<span class="java&#45;quote">"1.0"</span> encoding=<span class="java&#45;quote">"UTF&#45;8"</span>?&#62;
      &#60;mets xmlns=<span class="java&#45;quote">"http://www.loc.gov/METS/"</span> OBJID=<span class="java&#45;quote">"10622/ARCH00483.511"</span>&#62;
          &#60;fileSec&#62;
              &#60;fileGrp ID=<span class="java&#45;quote">"master"</span> USE=<span class="java&#45;quote">"archive image"</span>&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"7ce13c6f87930f456a315ae2b8f4f599"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;24T20:09:14Z"</span> ID=<span class="java&#45;quote">"f1"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/tiff"</span> SIZE=<span class="java&#45;quote">"112909902"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;a?locatt=view:master"</span>
                              xlink:title=<span class="java&#45;quote">"page_00001.tif"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"db4baeeaa72f9d70248dc86243ec67a6"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;24T16:10:37Z"</span> ID=<span class="java&#45;quote">"f2"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/tiff"</span> SIZE=<span class="java&#45;quote">"34832744"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;b?locatt=view:master"</span>
                              xlink:title=<span class="java&#45;quote">"page_00002.tif"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"b94a379b69a22a06733c099fae756d5b"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;24T27:10:25Z"</span> ID=<span class="java&#45;quote">"f3"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/tiff"</span> SIZE=<span class="java&#45;quote">"34609288"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/another&#45;identifier&#45;c?locatt=view:master"</span>
                              xlink:title=<span class="java&#45;quote">"page_00003.tif"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
              &#60;/fileGrp&#62;
              &#60;fileGrp ID=<span class="java&#45;quote">"level1"</span> USE=<span class="java&#45;quote">"hires reference image"</span>&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"372fc2b527e841c87ae1981203853ecb"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T12:01:34Z"</span> ID=<span class="java&#45;quote">"f40"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"281588"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;a?locatt=view:level1"</span>
                              xlink:title=<span class="java&#45;quote">"page_00001.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"5b6375afa835b2737ddc785de94c78df"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T12:01:35Z"</span> ID=<span class="java&#45;quote">"f41"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"524663"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;b?locatt=view:level1"</span>
                              xlink:title=<span class="java&#45;quote">"page_00002.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"a575e7376590a77451fa2c5d0cc6b388"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T12:01:36Z"</span> ID=<span class="java&#45;quote">"f42"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"544376"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/another&#45;identifier&#45;c?locatt=view:level1"</span>
                              xlink:title=<span class="java&#45;quote">"page_00003.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
              &#60;/fileGrp&#62;
              &#60;fileGrp ID=<span class="java&#45;quote">"level2"</span> USE=<span class="java&#45;quote">"reference image"</span>&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"1131b5eaabd7eb8266295dfa6e9deb15"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T49:03:54Z"</span> ID=<span class="java&#45;quote">"f79"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"40477"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;a?locatt=view:level2"</span>
                              xlink:title=<span class="java&#45;quote">"page_00001.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"29b93e7a719c6235f63822cbd31cf310"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T49:03:56Z"</span> ID=<span class="java&#45;quote">"f80"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"74001"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;b?locatt=view:level2"</span>
                              xlink:title=<span class="java&#45;quote">"page_00002.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"e237e2a6cbac9e12b92b870e7845f211"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T49:03:57Z"</span> ID=<span class="java&#45;quote">"f81"</span>
                        MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"82348"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/another&#45;identifier&#45;c?locatt=view:level2"</span>
                              xlink:title=<span class="java&#45;quote">"page_00003.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
              &#60;/fileGrp&#62;
              &#60;fileGrp ID=<span class="java&#45;quote">"level3"</span> USE=<span class="java&#45;quote">"thumbnail image"</span>&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"51935fb67bbb50b2d2908401ba95119e"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T49:03:57Z"</span>
                        ID=<span class="java&#45;quote">"f118"</span> MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"2644"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;a?locatt=view:level3"</span>
                              xlink:title=<span class="java&#45;quote">"page_00001.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"0f012b9052011cfa9791783895931505"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T49:03:58Z"</span>
                        ID=<span class="java&#45;quote">"f119"</span> MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"3864"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/my&#45;identifier&#45;b?locatt=view:level3"</span>
                              xlink:title=<span class="java&#45;quote">"page_00002.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
                  &#60;file CHECKSUM=<span class="java&#45;quote">"844a307af425882c241d8f8256fc1698"</span> CHECKSUMTYPE=<span class="java&#45;quote">"MD5"</span> CREATED=<span class="java&#45;quote">"2013&#45;03&#45;27T50:03:00Z"</span>
                        ID=<span class="java&#45;quote">"f120"</span> MIMETYPE=<span class="java&#45;quote">"image/jpeg"</span> SIZE=<span class="java&#45;quote">"4676"</span>&#62;
                      &#60;FLocat LOCTYPE=<span class="java&#45;quote">"HANDLE"</span> xmlns:xlink=<span class="java&#45;quote">"http://www.w3.org/1999/xlink"</span>
                              xlink:href=<span class="java&#45;quote">"http://hdl.handle.net/12345/another&#45;identifier&#45;c?locatt=view:level3"</span>
                              xlink:title=<span class="java&#45;quote">"page_00003.jpeg"</span> xlink:type=<span class="java&#45;quote">"simple"</span>/&#62;
                  &#60;/file&#62;
              &#60;/fileGrp&#62;
          &#60;/fileSec&#62;
          &#60;structMap TYPE=<span class="java&#45;quote">"physical"</span>&#62;
              &#60;div&#62;
                  &#60;div ID=<span class="java&#45;quote">"g0"</span> LABEL=<span class="java&#45;quote">"Page 1"</span> ORDER=<span class="java&#45;quote">"1"</span> TYPE=<span class="java&#45;quote">"page"</span>&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f1"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f40"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f79"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f118"</span>/&#62;
                  &#60;/div&#62;
                  &#60;div ID=<span class="java&#45;quote">"g1"</span> LABEL=<span class="java&#45;quote">"Page 2"</span> ORDER=<span class="java&#45;quote">"2"</span> TYPE=<span class="java&#45;quote">"page"</span>&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f2"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f41"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f80"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f119"</span>/&#62;
                  &#60;/div&#62;
                  &#60;div ID=<span class="java&#45;quote">"g2"</span> LABEL=<span class="java&#45;quote">"Page 3"</span> ORDER=<span class="java&#45;quote">"3"</span> TYPE=<span class="java&#45;quote">"page"</span>&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f3"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f42"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f81"</span>/&#62;
                      &#60;fptr FILEID=<span class="java&#45;quote">"f120"</span>/&#62;
                  &#60;/div&#62;
              &#60;/div&#62;
          &#60;/structMap&#62;
      &#60;/mets&#62;</pre></div>


<h2 id="pdf">7.3 Pdf</h2>
Another way compound objects are expressed is via PDF.
This is possible when at least one of the derivative layers is made from images.<p class="paragraph"/>The dissemination URL of a pdf document is:
http://disseminate.objectrepository.org/pdf/12345/my-object-id
which defaults to the rendering of a pdf with a level 2 derivative<p class="paragraph"/>You can specify the level yourself by adding it to the url so:
http://disseminate.objectrepository.org/pdf/12345/my-object-id/derivative level<p class="paragraph"/><blockquote class="note">If the level has a restrictive access, the pdf will not render</blockquote><p class="paragraph"/>The PID of the compound object will resolve to the the <code>pdfLevel</code> element set in instruction. See <a href="../guide/single.html#pids" class="guide">pids</a>.


<h1 id="administration">8 Administration interface</h1>
The administration interface is where a CP administrator can:
<ul class="star">
<li>create ftp accounts.</li>
<li>set a profile. That is, defaults for the processing instruction such as access, mimetype, the prefered services to use</li>
<li>define access policies</li>
<li>oversee the production of instructions, starting procedures and monitor the status</li>
<li>download technical metadata of stored material</li>
</ul><p class="paragraph"/> Access to the administration interface is possible via a privileged account only. Such accounts cannot be set
 via the administration interface directly. Contact the administrator directly to set such accounts.


<h2 id="user">8.1 Ftp accounts</h2>
The account section will allow you manage ftp accounts for uploading and managing files on the staging area.
An additional function of such accounts is to to supply webservice keys.
This key gives access to all admin and stored repository resources.<p class="paragraph"/><h4>Create a user</h4>
You need to fill in or edit the following fields:
<ul class="star">
<li><code>Login name</code>: A user name containing letters and numbers</li>
<li><code>Password</code>: If the password is left blank, a random password will be created</li>
<li><code>E-mail</code>: The end-user's mail address.</li>
<li><code>Enabled</code>: If on, the account can be used to login.</li>
</ul><p class="paragraph"/>Press save to store. An account confirmation message is sent to the e-mail. It contains all user and ftp details
to login.<p class="paragraph"/><h4>User display</h4>
This view will also show the webservice key. The key is intended to access an object repository resource that is
normally closed for anonymous users. The key needs to be attached to the resolve URL that points to a resource.
Or be in the header file of a client that is responsible for downloading the files.<p class="paragraph"/>The webservice key has the same effect when a user uses a username and password to access the administration interface.<p class="paragraph"/>To modify the webservice key select "Change key"<p class="paragraph"/><h4>editing and removing</h4>
Any account can be modified and deleted. If you delete an ftp account; the user's uploaded files and home
directory still remain on the staging area. You need to move or delete these yourself with your administration account.



<h2 id="profile">8.2 Profile</h2>
The profile is where you set the default values that are taken over by any processing instruction. That is:  Settings in
the profile substitute any absent values in the XML processing instruction. It makes sense therefore, to place all your
broad access policies and most frequently used file content values.<p class="paragraph"/>The available options are described at the <a href="../guide/single.html#settings" class="guide">settings section</a>.


<h2 id="policy">8.3 Access policies</h2>
A policy determines what an  <em class="italic">anonymous user</em>   can and cannot do. Lets say that is a person with a webbrowser who is not
logged on to the object repository. Access to each master file and its related derivatives are thus governed by a
policy.<p class="paragraph"/>There are three main policies available:
<table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">policy</strong></th><th><strong class="bold">access</strong></th></tr><tr class="table-odd"><td>closed</td><td>no files can be downloaded or viewed</td></tr><tr class="table-even"><td>restricted</td><td>level 1 derivatives are  <em class="italic">restricted</em> ; level 2 and 3 are viewable to the world</td></tr><tr class="table-odd"><td>open</td><td>All derivatives are viewable to the world</td></tr></table><p class="paragraph"/>The meaning of <strong class="bold">restricted</strong> means the anonymous user can only see the file with a webservice key. Even though
at this moment this is not the case, this setting can be used to offer for example a "give me persmission to see this
file" option. This will never be the case when the file is closed.<p class="paragraph"/><h3>Custom policies</h3>
You cannot modify these default policies, but to add your own custom policy is easily done by selecting "New Policy".
For each master and derivative you can  determine it's access level.



<h2 id="instructions">8.4 Managing and monitoring instructions</h2>
Each main folder in the staging area you see is represented here.<p class="paragraph"/>The moment when a XML instruction is offered; or when it is autocreated, the number of declared files will show up.
In addition each file will have a validation status. The files can be viewed by selecting the link of the main folder.<p class="paragraph"/><h3>Commands</h3>
<code>Autocreate</code>
This will autocreate an instruction. Press it and depending on the number of files, the instruction will be put into
the database.<p class="paragraph"/><code>Recreate</code>
This option is available at the "Stored objects panel". It will reconstruct an earlier used instruction.
This command will not work, if there are still files staged with an existing instruction.<p class="paragraph"/><code>Download</code>
One you created or uploaded an instruction, it can be downloaded as an XML instruction document.<p class="paragraph"/><blockquote class="note">Unfortunately, the download onto to the staging area of an instruction is not possible because of server
permissions. Choose the "download instructions via the browser" option in stead.</blockquote><p class="paragraph"/><code>Upload</code>
You can upload a XML instruction here so it will be placed on the staging area. FTP is also a way of uploading an
instruction.<p class="paragraph"/><code>Validate</code>
Will perform a check on the instruction vis-a-vis the files in the staging area.<p class="paragraph"/><code>Process files</code>
Kick starts the instruction<p class="paragraph"/><blockquote class="note">
If you monitor the progress of for example an upload, creation or validation of an instruction it will eventually
finish. However no <code>ingest instruction</code> option seems to appear. To make it appear, press the browser's refresh button.
</blockquote><p class="paragraph"/><h3>Monitoring</h3>
Each phase or step in the creation and running of an instruction can be monitored. The same for each individual files.
During an ingest, you can see the accumulative result of all files by selecting the link of the main folder.<p class="paragraph"/><h4>Instruction status</h4>
This is the particular status of an instruction.<p class="paragraph"/><img border="0" class="center" src="../img/statusinstruction.gif"></img><p class="paragraph"/><h4>Files status accumulative</h4>
All progress for the files<p class="paragraph"/><img border="0" class="center" src="../img/statusfiles.gif"></img><p class="paragraph"/><h4>Per file view</h4>
<img border="0" class="center" src="../img/statusfile.gif"></img><p class="paragraph"/><h4>Success and retries</h4>
When all services of a file have completed, the file reference will be removed from the staging area. In the end all
the declared files will be gone.<p class="paragraph"/>Of course, things can go wrong. In that case the error is mentioned and nothing will happen until the issue is resolved.
If you feel this is because of a bug or system application failure, please contact the service desk that operates the
object repository.<p class="paragraph"/>You can rerun instructions with different options. For example, because you want to change a label, access status,
produce derivatives, etc.


<h2 id="orfiles">8.5 Stored files</h2>
The files section will show all persisted files. Using the dropdown list, you can filter by instruction label.
Each file can be edited to change the policy and labeling.<p class="paragraph"/><img border="0" class="center" src="../img/orfiles.gif"></img><p class="paragraph"/>In addition, download all technical metadata as XML per file of for all the files. The XML does not follow a schema
and is subject to change.<p class="paragraph"/><code>Recreate instruction</code>
If you select a label from from the dropdown list; then you can use that selection to recreate an instruction.<p class="paragraph"/><code>Find by pid</code>
Use the PID of a file to display it in the list. Or use the objid of the compound object to find all grouped files.

                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            Copyright (c) 2012 Social History Services
            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
