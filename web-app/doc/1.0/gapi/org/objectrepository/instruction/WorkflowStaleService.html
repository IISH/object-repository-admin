<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- **************************************************************** -->
<!-- *  PLEASE KEEP COMPLICATED EXPRESSIONS OUT OF THESE TEMPLATES, * -->
<!-- *  i.e. only iterate & print data where possible. Thanks, Jez. * -->
<!-- **************************************************************** -->

<html>
<head>
<!-- Generated by groovydoc (1.8.6) on Wed Jun 13 20:32:58 CEST 2012 -->
<title>WorkflowStaleService (Groovy Documentation)</title>
<meta name="date" content="2012-06-13">
<link href="../../../groovy.ico" type="image/x-icon" rel="shortcut icon">
<link href="../../../groovy.ico" type="image/x-icon" rel="icon">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="WorkflowStaleService (Groovy Documentation)";
    }
}
</script>
<noscript>
</noscript>

</head><body onload="windowTitle();" bgcolor="white">
<hr>

<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>

  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <!--<TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  -->
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<b>Groovy Documentation</b>
</EM></TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><!--<FONT SIZE="-2">
&nbsp;<A HREF="../../../groovy/lang/ExpandoMetaClass.ExpandoMetaProperty.html" title="class in groovy.lang"><B>PREV CLASS</B></A>&nbsp;

&nbsp;<A HREF="../../../groovy/lang/GroovyClassLoader.html" title="class in groovy.lang"><B>NEXT CLASS</B></A></FONT>--></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/objectrepository/instruction/WorkflowStaleService.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="WorkflowStaleService.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<script type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-frame.html"><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
  <A HREF="../../../allclasses-frame.html"><B>All Classes</B></A>
</noscript>

</FONT></TD>

</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- ========= END OF TOP NAVBAR ========= -->


<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>

<FONT SIZE="-1">
org.objectrepository.instruction</FONT>
<BR>

<span CLASS="ClassTitleFont">[Groovy] Class WorkflowStaleService</span></H2>
<pre>java.lang.Object
  <img src='../../../inherit.gif'><a href='../../../org/objectrepository/instruction/WorkflowJob.html'>org.objectrepository.instruction.WorkflowJob</a>
      <img src='../../../inherit.gif'>org.objectrepository.instruction.WorkflowStaleService
</pre><hr>
<PRE>class WorkflowStaleService
extends <a href='../../../org/objectrepository/instruction/WorkflowJob.html'>WorkflowJob</a>

</PRE>

<P>
 WorkflowStaleService

 Looks at each of the instruction and Stagingfile current status

 The service node will sent frequent status updated ( or confirmations of it ) to the status queue.
 As the document.task.end date is then updated, we always know the process is still active.

 Should however the status not be updated... we have detected a problem.
 Possible the service node has aborted a job and was not able to tell us about it. Or it did succeed.
 Another rare possibility is that the client is down or even the message got lost.

 In that case, the move the statusCode of the job to 600 and will await validation.

 author: Lucien van Wouw <lwo@iisg.nl>
 
</P>
<hr>


<!-- =========== NESTED CLASS SUMMARY =========== -->

<A NAME="nested_summary"><!-- --></A>


<!-- =========== ENUM CONSTANT SUMMARY =========== -->

<A NAME="enum_constant_summary"><!-- --></A>


<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
    <B>Field Summary</B></FONT></TH>
    </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;static&nbsp;int</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#StatusCodeQueued">StatusCodeQueued</A></B></CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;static&nbsp;int</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#StatusCodeRestartQueued">StatusCodeRestartQueued</A></B></CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;static&nbsp;int</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#StatusCodeTaskCompleteReceipt">StatusCodeTaskCompleteReceipt</A></B></CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;static&nbsp;int</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#StatusCodeTaskReceipt">StatusCodeTaskReceipt</A></B></CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;static&nbsp;int</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#periodQueued">periodQueued</A></B></CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
        <CODE>private&nbsp;static&nbsp;int</CODE></FONT></TD>
        <TD>
            <CODE><B><A HREF="#periodTaskReceipt">periodTaskReceipt</A></B></CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
    </TABLE>
    &nbsp;


<!-- =========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>


<!-- =========== ELEMENT SUMMARY =========== -->



<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#D5D5FF" CLASS="TableHeadingColor">
    <TD COLSPAN=2><FONT SIZE="+2">
    <B>Constructor Summary</B></FONT></TD>
    </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD>
            <CODE><B><a href="#WorkflowStaleService()">WorkflowStaleService</a></B>()</CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
    </TABLE>
    &nbsp;


<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2" CLASS="ClassHeadingFont">
    <B>Method Summary</B></FONT></TH>
    </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1" CLASS="ClassItemFont">
            <CODE>private&nbsp;void</CODE></FONT>
        </TD>
        <TD>
            <CODE><b><a href="#checkStaleness(int, int, java.util.Date)">checkStaleness</a></b>(int currentStatusCode, int newStatusCode, java.util.Date date)</CODE>
            <BR>
            <P></P>
        </TD>
        </TR>
    
        <TR BGCOLOR="white" CLASS="TableRowColor">
        <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1" CLASS="ClassItemFont">
            <CODE>void</CODE></FONT>
        </TD>
        <TD>
            <CODE><b><a href="#job()">job</a></b>()</CODE>
            <BR>
            <P>job</P>
        </TD>
        </TR>
    
    </TABLE>
    &nbsp;
<table BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
                <tr CLASS="TableSubHeadingColor"><th ALIGN="left" COLSPAN="2">
                <b>Methods inherited from class <a href='../../../org/objectrepository/instruction/WorkflowJob.html'>WorkflowJob</a></b>
                </th></tr>
                <tr class="TableRowColor"><td colspan='2'><a href='../../../org/objectrepository/instruction/WorkflowJob.html#EndOfTheRoad800(def)'>EndOfTheRoad800</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#Instruction800(def)'>Instruction800</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#Start100(def)'>Start100</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#changeWorkflow(java.lang.String, def)'>changeWorkflow</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#currentTask(def)'>currentTask</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#delete(def)'>delete</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#exception(def, java.lang.Exception)'>exception</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#first(def)'>first</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#firstStatusCode(java.lang.String)'>firstStatusCode</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#getHome()'>getHome</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#getPlans()'>getPlans</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#id(def)'>id</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#last(def)'>last</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#message(def)'>message</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#methodName(def)'>methodName</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#next(def)'>next</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#nextWorkflow(def)'>nextWorkflow</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#result(com.mongodb.WriteResult)'>result</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#retry(def)'>retry</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#runMethod(def)'>runMethod</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#runMethod(def, java.lang.String)'>runMethod</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#save(def)'>save</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#saveWorkflow(def)'>saveWorkflow</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#task100(def)'>task100</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#task200(def)'>task200</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#task500(def)'>task500</a>, <a href='../../../org/objectrepository/instruction/WorkflowJob.html#task600(def)'>task600</a></td></tr>
                </table>
                &nbsp;

<P>

<!-- ============ ENUM CONSTANT DETAIL ========== -->

<A NAME="enum_constant_detail"><!-- --></A>


<!-- =========== FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
    <B>Field Detail</B></FONT></TH>
    </TR>
    </TABLE>
    
        <A NAME="StatusCodeQueued"><!-- --></A><H3>StatusCodeQueued</H3>
        <PRE>private&nbsp;static&nbsp;final&nbsp;int <B>StatusCodeQueued</B></PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="StatusCodeRestartQueued"><!-- --></A><H3>StatusCodeRestartQueued</H3>
        <PRE>private&nbsp;static&nbsp;final&nbsp;int <B>StatusCodeRestartQueued</B></PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="StatusCodeTaskCompleteReceipt"><!-- --></A><H3>StatusCodeTaskCompleteReceipt</H3>
        <PRE>private&nbsp;static&nbsp;final&nbsp;int <B>StatusCodeTaskCompleteReceipt</B></PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="StatusCodeTaskReceipt"><!-- --></A><H3>StatusCodeTaskReceipt</H3>
        <PRE>private&nbsp;static&nbsp;final&nbsp;int <B>StatusCodeTaskReceipt</B></PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="periodQueued"><!-- --></A><H3>periodQueued</H3>
        <PRE>private&nbsp;static&nbsp;int <B>periodQueued</B></PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="periodTaskReceipt"><!-- --></A><H3>periodTaskReceipt</H3>
        <PRE>private&nbsp;static&nbsp;int <B>periodTaskReceipt</B></PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
    &nbsp;


<!-- =========== PROPERTY DETAIL =========== -->

<A NAME="prop_detail"><!-- --></A>


<!-- =========== ELEMENT DETAIL =========== -->

<A NAME="element_detail"><!-- --></A>


<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
    <B>Constructor Detail</B></FONT></TH>
    </TR>
    </TABLE>
    
        <A NAME="WorkflowStaleService()"><!-- --></A><H3>
        WorkflowStaleService</H3>
        <PRE><B>WorkflowStaleService</B>()</PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
    &nbsp;


<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>

    <TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
    <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
    <TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
    <B>Method Detail</B></FONT></TH>
    </TR>
    </TABLE>
    
        <A NAME="checkStaleness(int, int, java.util.Date)"><!-- --></A><H3>
        checkStaleness</H3>
        <PRE>private&nbsp;void <B>checkStaleness</B>(int currentStatusCode, int newStatusCode, java.util.Date date)</PRE>
        <DL>
        <DD>
        </DD>
        <P>
        </DL>
        <HR>
    
        <A NAME="job()"><!-- --></A><H3>
        job</H3>
        <PRE>void <B>job</B>()</PRE>
        <DL>
        <DD> job

 Find all documents with a stale task.
 Sets the task statusCode 300 to StatusCodeStart if found stale.
 Sets the task statusCode 400 to StatusCodeTaskCompleteReceipt if found stale.
 This only means the active workflow will pick it up and move it to a 600 check where it will probably retry it.
     
        </DD>
        <P>
        </DL>
        <HR>
    
    &nbsp;


<!-- ========= END OF CLASS DATA ========= -->
<p>Groovy Documentation</p>
<hr>

</body>
</html>
